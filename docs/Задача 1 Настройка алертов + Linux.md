# 1. Настройка бюджета и алертов о превышении

## Документация по теме:
https://yandex.cloud/ru/docs/billing/concepts/budget
https://yandex.cloud/ru/docs/billing/operations/budgets

## Действия

Перейдите в сервис Yandex Cloud Billing

Выберите аккаунт на странице Платёжные аккаунты.

Перейдите на страницу Бюджеты и нажмите Создать бюджет.

    Введите имя бюджета.

    Выберите Тип бюджета.

    Задайте Сумму бюджета:
        для типов Стоимость потребления или К оплате — сумму расходов на потребление;
        для типа Остаток средств — остаток на лицевом счете.

    Для типов Стоимость потребления и К оплате выберите период расчета бюджета:
        Если вы выбрали Настраиваемый период, задайте дату начала действия бюджета. Дата начала — первое число заданного месяца.
        Задайте дату окончания действия бюджета. Дата окончания устанавливает, когда бюджет перестанет считать потребление или остаток средств и отправлять уведомления. Дата окончания — последнее число месяца. Не может быть позже пяти лет от текущей даты.

    В поле Уведомить выберите пользователей, которые получат уведомление.

    Для типов Стоимость потребления и К оплате определите Область действия бюджета. Вы можете выбрать отдельные облака, каталоги и сервисы, которые будут входить в установленный бюджет. По умолчанию данные собираются со всех облаков, каталогов и сервисов, доступных выбранному платежному аккаунту.

    Установите хотя бы один порог потребления, при котором будут отправлены уведомления. Вы можете указать пороговое значение в процентах или валюте и выбрать пользователей, которые получат уведомления. Бюджет может иметь несколько пороговых значений.

Когда отправка уведомлений настроена - указать почту\телефон\телеграмм выбрав в левом боковом меню Настройки\Уведомления

# 2. Создать репозиторий на GitHub для дальнейшей работы (сохранение всех конфигов nginx, docker и тд)
### Создать локальный
```bash
mkdir 'name' && cd 'name'
git init 
```
### Создать удаленный
https://github.com/new 

### Связать
```bash
git remote add origin 'origin link'
```
# 3. С помощью команд из консоли: 
## 3.1 Определить ip сайта google.com и проверить его доступность
```bash
ping google.com
```
ip: 142.250.184.142
Доступен)
## 3.2 Определить маршрут следования пакета от инстанса до google.com
```bash
traceroute google.com
```
## 3.3 Определить какие порты инстанса используются в данный момент сервисами и определить какое приложение работает на порту 80;

```bash
ss -tlpn 
# all ports
```
```bash
ss -tlpn | grep 80
# only 80

```
## 3.4 Показать какие ip routes настроены на машине, показать какой ip у твоей машины, какой hostname
```bash
ip route show
```
```bash
hostname -i
```
```bash
hostname
```
## 3.5 Показать таблицу iptables, запретить входящие ICMP пакеты и показать что ping отвалился;

```bash
sudo iptables -L -n
```
---
> При запросе `how to block icmp packets` самый популярный ответ - `pls dont` ;)
```bash
sudo iptables -A INPUT -p icmp -j DROP
```
Результат этой чудесной команды - 100% packet loss в ping
Исправить это недоразумение - 
```bash
sudo iptables -D INPUT -p icmp -j DROP
```
## 3.6 На локалке сделать так, чтобы dns запись google.com вела на другой сайт;

> [!/etc/hosts]
> 'ip на другой сайт' google.com

Вообще, по хорошему этого должно бы и хватить, но вот мой браузер например автоматически перезаписывает любые внешние адреса через cloudflare dns, так что через ping - прокатит, через браузер - по хорошему надо менять настройки браузера
## 3.7Просмотреть список запущеных процессов, объяснить вывод команды ps auxft, объяснить какой процесс под PID 1, показать дочерние процессы процесса PID 1. Что такое RSS, VSZ, NI, PRI, STAT, какой процесс используется твоим терминалом;
Список всех процессов - 
```bash
ps -ax
```
-u добавляет отображение пользователя, владельца процесса
```bash
ps -aux
```
-f расширяет вывод информации, показывает дерево дочерних процессов
```bash
ps -axf
```
-t преобразует вывод cmd в путь до исполняемого файла
```bash
ps -axt
```
---
PID 1 - Это **init process** управляющий сервисами , на моей машине это systemd
Дочерние процессы можно вывести через 
```bash
ps --ppid 1
```
---
- RSS - Реальная память потребляемая процессом в настоящий момент
- VSZ - Выделенная процессу память
- NI - насколько процесс "Nice" , больше значение - меньше приоритет.
- PRI - приоритет процесса
- STAT - Статус процесса e.g. действующий, спящий, зомби etc

Процесс терминала - 
```bash
ps ax | grep 'terminal name'
```
## 3.8 Показать какие службы systemd сейчас запущены и найти службу nginx, сделать hard и easy рестарт сервиса nginx, объяснить различие;

```bash
systemctl list-unit-files --state=enabled
```
"easy" рестарт ([только конфиги](https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units#restarting-and-reloading))
```bash
sudo systemctl reload nginx.service
```
"hard" рестарт
```bash
sudo systemctl restart nginx.service
```
## 3.9 Определить процессы которые имеют открытые файлы в директории /var/log, объяснить вывод использованной команды;
```bash
sudo lsof /var/log
```


| CMD          | PID    | USER         | FD               | TYPE                                   | DEVICE              | SIZE/OFF     | NODE        | NAME                           |
| ------------ | ------ | ------------ | ---------------- | -------------------------------------- | ------------------- | ------------ | ----------- | ------------------------------ |
| Имя процесса | Его id | Пользователь | Дескриптор файла | тип файла: директория или обычный файл | Номер устройтсва??? | Размер файла | inode номер | Путь в рамках файловой системы |


---
## 3.10 Показать сколько места занято на дисках, показать сколько места на диске занимает директория /var/log/. Аналогично показать сколько занято inodes на дисках и в директории /var/log/

Место на дисках - disk free
```bash
df
# Или 
df -h
```
Вес директории - dick usage
```
du -s 'path'
# Или
du -sh 'path'
```
inodes на дисках
```bash
df -i
# Или 
df -ih
```
inodes в директории
```bash
du --inodes -s 'path'
```
## 3.11 Показать с помощью man за что отвечает флаг -I в команде iptables (научиться ориентироваться в мануале).

```bash
man iptables
```
Вообще по мануалу можно поиском пройтись поиском, используя /'запрос', но это не очень удобно